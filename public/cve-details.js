// Extract the CVE ID from the URL query string
const urlParams = new URLSearchParams(window.location.search);
const cveId = urlParams.get('id');

// Function to fetch and display detailed CVE data
async function fetchCveDetails() {
    if (!cveId) {
        document.getElementById('cveDetails').textContent = 'No CVE ID provided';
        return;
    }

    try {
        const response = await fetch(`/cve-detail/${cveId}`); // Make a request to backend

        if (!response.ok) {
            throw new Error('Failed to fetch CVE details');
        }

        const data = await response.json(); // Parse the JSON response

        // Display the CVE details in a readable format
        const cveDetailsDiv = document.getElementById('cveDetails');
        cveDetailsDiv.innerHTML = `
            <p><strong>CVE ID:</strong> ${data.cve.id}</p>
            <p><strong>Source Identifier:</strong> ${data.cve.sourceIdentifier}</p>
            <p><strong>Published Date:</strong> ${data.cve.published}</p>
            <p><strong>Last Modified:</strong> ${data.cve.lastModified}</p>
            <p><strong>Status:</strong> ${data.cve.vulnStatus}</p>
            <p><strong>Description:</strong> ${data.cve.description || 'No description available'}</p>
        `;
    } catch (error) {
        console.error('Error fetching CVE details:', error);
        document.getElementById('cveDetails').textContent = 'Failed to load CVE details';
    }
}

// Load the CVE details when the page loads
fetchCveDetails();
